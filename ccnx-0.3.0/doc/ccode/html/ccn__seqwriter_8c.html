<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Content-Centric Networking in C: lib/ccn_seqwriter.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_3670a7f7f4c45e09473a6615bf7486a4.html">lib</a>
  </div>
</div>
<div class="contents">
<h1>ccn_seqwriter.c File Reference</h1>
<p>Part of the CCNx C Library.  
<a href="#_details">More...</a></p>

<p><a href="ccn__seqwriter_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccn__seqwriter_8c.html#a87f68e96fb938eddc39ad1f19d923a96">MAX_DATA_SIZE</a>&nbsp;&nbsp;&nbsp;4096</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structccn__charbuf.html">ccn_charbuf</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccn__seqwriter_8c.html#a7efd1ac8ba643c426762e3ae6783f78c">seqw_next_cob</a> (struct ccn_seqwriter *w)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static enum <a class="el" href="ccn_8h.html#ac4cc3fdb432fd23cdc0c5642276b0ddc">ccn_upcall_res</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccn__seqwriter_8c.html#ac486e358e68297e5564ad2e3108e2bc6">seqw_incoming_interest</a> (struct <a class="el" href="structccn__closure.html">ccn_closure</a> *selfp, enum <a class="el" href="ccn_8h.html#a5fcebad21626ea80c67775c092011c92">ccn_upcall_kind</a> kind, struct <a class="el" href="structccn__upcall__info.html">ccn_upcall_info</a> *info)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct ccn_seqwriter *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccn__seqwriter_8c.html#a5813d07336301f112e452c38ae3dab35">ccn_seqw_create</a> (struct ccn *h, struct <a class="el" href="structccn__charbuf.html">ccn_charbuf</a> *name)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a seqwriter for writing data to a versioned, segmented stream.  <a href="#a5813d07336301f112e452c38ae3dab35"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccn__seqwriter_8c.html#a679b0694a43c699371a3b64340d0f2d5">ccn_seqw_write</a> (struct ccn_seqwriter *w, const void *buf, size_t size)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write some data to a seqwriter.  <a href="#a679b0694a43c699371a3b64340d0f2d5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccn__seqwriter_8c.html#aca5f5c9f5cbc8d992670bb17ded30c45">ccn_seqw_batch_start</a> (struct ccn_seqwriter *w)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Start a batch of writes.  <a href="#aca5f5c9f5cbc8d992670bb17ded30c45"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccn__seqwriter_8c.html#a478eecf445a9840ab0cf88c33687e37f">ccn_seqw_batch_end</a> (struct ccn_seqwriter *w)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">End a batch of writes.  <a href="#a478eecf445a9840ab0cf88c33687e37f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccn__seqwriter_8c.html#a55f3c680cd41baeb397ce2cb4db86e51">ccn_seqw_possible_interest</a> (struct ccn_seqwriter *w)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Assert that an interest has possibly been expressed that matches the seqwriter's data.  <a href="#a55f3c680cd41baeb397ce2cb4db86e51"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccn__seqwriter_8c.html#a5231e9392354417928109774ea95da28">ccn_seqw_close</a> (struct ccn_seqwriter *w)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Close the seqwriter, which will be freed.  <a href="#a5231e9392354417928109774ea95da28"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Part of the CCNx C Library. </p>
<p>Copyright (C) 2010 Palo Alto Research Center, Inc.</p>
<p>This library is free software; you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License version 2.1 as published by the Free Software Foundation. This library is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details. You should have received a copy of the GNU Lesser General Public License along with this library; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA. </p>

<p>Definition in file <a class="el" href="ccn__seqwriter_8c_source.html">ccn_seqwriter.c</a>.</p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a87f68e96fb938eddc39ad1f19d923a96"></a><!-- doxytag: member="ccn_seqwriter.c::MAX_DATA_SIZE" ref="a87f68e96fb938eddc39ad1f19d923a96" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_DATA_SIZE&nbsp;&nbsp;&nbsp;4096</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ccn__seqwriter_8c_source.html#l00028">28</a> of file <a class="el" href="ccn__seqwriter_8c_source.html">ccn_seqwriter.c</a>.</p>

<p>Referenced by <a class="el" href="ccn__seqwriter_8c_source.html#l00188">ccn_seqw_write()</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a478eecf445a9840ab0cf88c33687e37f"></a><!-- doxytag: member="ccn_seqwriter.c::ccn_seqw_batch_end" ref="a478eecf445a9840ab0cf88c33687e37f" args="(struct ccn_seqwriter *w)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ccn_seqw_batch_end </td>
          <td>(</td>
          <td class="paramtype">struct ccn_seqwriter *&nbsp;</td>
          <td class="paramname"> <em>w</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>End a batch of writes. </p>

<p>Definition at line <a class="el" href="ccn__seqwriter_8c_source.html#l00243">243</a> of file <a class="el" href="ccn__seqwriter_8c_source.html">ccn_seqwriter.c</a>.</p>

<p>Referenced by <a class="el" href="ccnd__internal__client_8c_source.html#l00480">ccnd_notice_push()</a>.</p>

</div>
</div>
<a class="anchor" id="aca5f5c9f5cbc8d992670bb17ded30c45"></a><!-- doxytag: member="ccn_seqwriter.c::ccn_seqw_batch_start" ref="aca5f5c9f5cbc8d992670bb17ded30c45" args="(struct ccn_seqwriter *w)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ccn_seqw_batch_start </td>
          <td>(</td>
          <td class="paramtype">struct ccn_seqwriter *&nbsp;</td>
          <td class="paramname"> <em>w</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Start a batch of writes. </p>
<p>This will delay the signing of content objects until the batch ends, producing a more efficient result. Must have a matching <a class="el" href="seqwriter_8h.html#a478eecf445a9840ab0cf88c33687e37f" title="End a batch of writes.">ccn_seqw_batch_end()</a> call. Batching may be nested. </p>

<p>Definition at line <a class="el" href="ccn__seqwriter_8c_source.html#l00232">232</a> of file <a class="el" href="ccn__seqwriter_8c_source.html">ccn_seqwriter.c</a>.</p>

<p>Referenced by <a class="el" href="ccnd__internal__client_8c_source.html#l00480">ccnd_notice_push()</a>.</p>

</div>
</div>
<a class="anchor" id="a5231e9392354417928109774ea95da28"></a><!-- doxytag: member="ccn_seqwriter.c::ccn_seqw_close" ref="a5231e9392354417928109774ea95da28" args="(struct ccn_seqwriter *w)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ccn_seqw_close </td>
          <td>(</td>
          <td class="paramtype">struct ccn_seqwriter *&nbsp;</td>
          <td class="paramname"> <em>w</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Close the seqwriter, which will be freed. </p>

<p>Definition at line <a class="el" href="ccn__seqwriter_8c_source.html#l00271">271</a> of file <a class="el" href="ccn__seqwriter_8c_source.html">ccn_seqwriter.c</a>.</p>

<p>Referenced by <a class="el" href="ccnseqwriter_8c_source.html#l00040">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a5813d07336301f112e452c38ae3dab35"></a><!-- doxytag: member="ccn_seqwriter.c::ccn_seqw_create" ref="a5813d07336301f112e452c38ae3dab35" args="(struct ccn *h, struct ccn_charbuf *name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct ccn_seqwriter* ccn_seqw_create </td>
          <td>(</td>
          <td class="paramtype">struct ccn *&nbsp;</td>
          <td class="paramname"> <em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structccn__charbuf.html">ccn_charbuf</a> *&nbsp;</td>
          <td class="paramname"> <em>name</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Create a seqwriter for writing data to a versioned, segmented stream. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>name</em>&nbsp;</td><td>is a ccnb-encoded Name. It will be provided with a version based on the current time unless it already ends in a version component. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ccn__seqwriter_8c_source.html#l00130">130</a> of file <a class="el" href="ccn__seqwriter_8c_source.html">ccn_seqwriter.c</a>.</p>

<p>Referenced by <a class="el" href="ccnd__internal__client_8c_source.html#l00536">ccnd_start_notice()</a>, and <a class="el" href="ccnseqwriter_8c_source.html#l00040">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a55f3c680cd41baeb397ce2cb4db86e51"></a><!-- doxytag: member="ccn_seqwriter.c::ccn_seqw_possible_interest" ref="a55f3c680cd41baeb397ce2cb4db86e51" args="(struct ccn_seqwriter *w)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ccn_seqw_possible_interest </td>
          <td>(</td>
          <td class="paramtype">struct ccn_seqwriter *&nbsp;</td>
          <td class="paramname"> <em>w</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Assert that an interest has possibly been expressed that matches the seqwriter's data. </p>
<p>This is useful, for example, if the seqwriter was created in response to an interest. </p>

<p>Definition at line <a class="el" href="ccn__seqwriter_8c_source.html#l00258">258</a> of file <a class="el" href="ccn__seqwriter_8c_source.html">ccn_seqwriter.c</a>.</p>

</div>
</div>
<a class="anchor" id="a679b0694a43c699371a3b64340d0f2d5"></a><!-- doxytag: member="ccn_seqwriter.c::ccn_seqw_write" ref="a679b0694a43c699371a3b64340d0f2d5" args="(struct ccn_seqwriter *w, const void *buf, size_t size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ccn_seqw_write </td>
          <td>(</td>
          <td class="paramtype">struct ccn_seqwriter *&nbsp;</td>
          <td class="paramname"> <em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write some data to a seqwriter. </p>
<p>This is roughly analogous to a write(2) call in non-blocking mode.</p>
<p>The current implementation returns an error and refuses the new data if it does not fit in the current buffer. That is, there are no partial writes. In this case, the caller should <a class="el" href="ccn_8h.html#a3efe1659b5387eb385044bcd48619603" title="Run the ccn client event loop.">ccn_run()</a> for a little while and retry.</p>
<p>It is also an error to attempt to write more than 4096 bytes.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>the size written, or -1 for an error. In case of an error, the caller may test <a class="el" href="ccn_8h.html#abd39c710dc95a559fc1401553ebd4f1a" title="Recover last error code.">ccn_geterror()</a> for values of EAGAIN or EINVAL from errno.h. </dd></dl>

<p>Definition at line <a class="el" href="ccn__seqwriter_8c_source.html#l00188">188</a> of file <a class="el" href="ccn__seqwriter_8c_source.html">ccn_seqwriter.c</a>.</p>

<p>Referenced by <a class="el" href="ccn__seqwriter_8c_source.html#l00243">ccn_seqw_batch_end()</a>, <a class="el" href="ccn__seqwriter_8c_source.html#l00271">ccn_seqw_close()</a>, <a class="el" href="ccn__seqwriter_8c_source.html#l00258">ccn_seqw_possible_interest()</a>, <a class="el" href="ccnseqwriter_8c_source.html#l00040">main()</a>, and <a class="el" href="ccnd__internal__client_8c_source.html#l00451">post_face_notice()</a>.</p>

</div>
</div>
<a class="anchor" id="ac486e358e68297e5564ad2e3108e2bc6"></a><!-- doxytag: member="ccn_seqwriter.c::seqw_incoming_interest" ref="ac486e358e68297e5564ad2e3108e2bc6" args="(struct ccn_closure *selfp, enum ccn_upcall_kind kind, struct ccn_upcall_info *info)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static enum <a class="el" href="ccn_8h.html#ac4cc3fdb432fd23cdc0c5642276b0ddc">ccn_upcall_res</a> seqw_incoming_interest </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structccn__closure.html">ccn_closure</a> *&nbsp;</td>
          <td class="paramname"> <em>selfp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="ccn_8h.html#a5fcebad21626ea80c67775c092011c92">ccn_upcall_kind</a>&nbsp;</td>
          <td class="paramname"> <em>kind</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structccn__upcall__info.html">ccn_upcall_info</a> *&nbsp;</td>
          <td class="paramname"> <em>info</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ccn__seqwriter_8c_source.html#l00063">63</a> of file <a class="el" href="ccn__seqwriter_8c_source.html">ccn_seqwriter.c</a>.</p>

<p>Referenced by <a class="el" href="ccn__seqwriter_8c_source.html#l00130">ccn_seqw_create()</a>.</p>

</div>
</div>
<a class="anchor" id="a7efd1ac8ba643c426762e3ae6783f78c"></a><!-- doxytag: member="ccn_seqwriter.c::seqw_next_cob" ref="a7efd1ac8ba643c426762e3ae6783f78c" args="(struct ccn_seqwriter *w)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structccn__charbuf.html">ccn_charbuf</a>* seqw_next_cob </td>
          <td>(</td>
          <td class="paramtype">struct ccn_seqwriter *&nbsp;</td>
          <td class="paramname"> <em>w</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ccn__seqwriter_8c_source.html#l00044">44</a> of file <a class="el" href="ccn__seqwriter_8c_source.html">ccn_seqwriter.c</a>.</p>

<p>Referenced by <a class="el" href="ccn__seqwriter_8c_source.html#l00188">ccn_seqw_write()</a>, and <a class="el" href="ccn__seqwriter_8c_source.html#l00063">seqw_incoming_interest()</a>.</p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Thu Nov 4 13:34:09 2010 for Content-Centric Networking in C by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
