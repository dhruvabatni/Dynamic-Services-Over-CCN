<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Content-Centric Networking in C: lib/ccn_versioning.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_3670a7f7f4c45e09473a6615bf7486a4.html">lib</a>
  </div>
</div>
<div class="contents">
<h1>ccn_versioning.c File Reference</h1>
<p>Versioning support.  
<a href="#_details">More...</a></p>

<p><a href="ccn__versioning_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccn__versioning_8c.html#a201a0d2d698f67adfe3f4ca209a3c7ff">FF</a>&nbsp;&nbsp;&nbsp;0xff</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccn__versioning_8c.html#abd958a51bdd3985e29249843cf90b982">append_filter_all</a> (struct <a class="el" href="structccn__charbuf.html">ccn_charbuf</a> *c)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This appends a filter useful for excluding everything between two 'fenceposts' in an Exclude construct.  <a href="#abd958a51bdd3985e29249843cf90b982"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccn__versioning_8c.html#a467dbea066ee2ba9349ceef137786d81">answer_passive</a> (struct <a class="el" href="structccn__charbuf.html">ccn_charbuf</a> *templ)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Append AnswerOriginKind=1 to partially constructed Interest, meaning do not generate new content.  <a href="#a467dbea066ee2ba9349ceef137786d81"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccn__versioning_8c.html#aa121a11b90462163830b98635e834381">answer_highest</a> (struct <a class="el" href="structccn__charbuf.html">ccn_charbuf</a> *templ)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Append ChildSelector to partially constructed Interest, meaning prefer to send rightmost available.  <a href="#aa121a11b90462163830b98635e834381"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccn__versioning_8c.html#a5c4d612727219c5b1155c31f2308947f">append_future_vcomp</a> (struct <a class="el" href="structccn__charbuf.html">ccn_charbuf</a> *templ)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structccn__charbuf.html">ccn_charbuf</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccn__versioning_8c.html#a7c3104b723d2ae204e7b853fdeab887b">resolve_templ</a> (struct <a class="el" href="structccn__charbuf.html">ccn_charbuf</a> *templ, unsigned const char *vcomp, int size)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccn__versioning_8c.html#ac6285f1a77360610cb68ddfe9769f495">ccn_resolve_version</a> (struct ccn *h, struct <a class="el" href="structccn__charbuf.html">ccn_charbuf</a> *name, int versioning_flags, int timeout_ms)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Resolve the version, based on existing ccn content.  <a href="#ac6285f1a77360610cb68ddfe9769f495"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccn__versioning_8c.html#af222a5e0ff25d4f2ff60eed72b3defb2">ccn_create_version</a> (struct ccn *h, struct <a class="el" href="structccn__charbuf.html">ccn_charbuf</a> *name, int versioning_flags, intmax_t secs, int nsecs)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Extend a Name with a new version stamp.  <a href="#af222a5e0ff25d4f2ff60eed72b3defb2"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Versioning support. </p>
<p>Part of the CCNx C Library.</p>
<p>Copyright (C) 2009-2010 Palo Alto Research Center, Inc.</p>
<p>This library is free software; you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License version 2.1 as published by the Free Software Foundation. This library is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details. You should have received a copy of the GNU Lesser General Public License along with this library; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA. </p>

<p>Definition in file <a class="el" href="ccn__versioning_8c_source.html">ccn_versioning.c</a>.</p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a201a0d2d698f67adfe3f4ca209a3c7ff"></a><!-- doxytag: member="ccn_versioning.c::FF" ref="a201a0d2d698f67adfe3f4ca209a3c7ff" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FF&nbsp;&nbsp;&nbsp;0xff</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ccn__versioning_8c_source.html#l00031">31</a> of file <a class="el" href="ccn__versioning_8c_source.html">ccn_versioning.c</a>.</p>

<p>Referenced by <a class="el" href="ccn__versioning_8c_source.html#l00124">ccn_resolve_version()</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="aa121a11b90462163830b98635e834381"></a><!-- doxytag: member="ccn_versioning.c::answer_highest" ref="aa121a11b90462163830b98635e834381" args="(struct ccn_charbuf *templ)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void answer_highest </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structccn__charbuf.html">ccn_charbuf</a> *&nbsp;</td>
          <td class="paramname"> <em>templ</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Append ChildSelector to partially constructed Interest, meaning prefer to send rightmost available. </p>

<p>Definition at line <a class="el" href="ccn__versioning_8c_source.html#l00062">62</a> of file <a class="el" href="ccn__versioning_8c_source.html">ccn_versioning.c</a>.</p>

<p>Referenced by <a class="el" href="ccn__versioning_8c_source.html#l00079">resolve_templ()</a>.</p>

</div>
</div>
<a class="anchor" id="a467dbea066ee2ba9349ceef137786d81"></a><!-- doxytag: member="ccn_versioning.c::answer_passive" ref="a467dbea066ee2ba9349ceef137786d81" args="(struct ccn_charbuf *templ)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void answer_passive </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structccn__charbuf.html">ccn_charbuf</a> *&nbsp;</td>
          <td class="paramname"> <em>templ</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Append AnswerOriginKind=1 to partially constructed Interest, meaning do not generate new content. </p>

<p>Definition at line <a class="el" href="ccn__versioning_8c_source.html#l00049">49</a> of file <a class="el" href="ccn__versioning_8c_source.html">ccn_versioning.c</a>.</p>

<p>Referenced by <a class="el" href="ccn__versioning_8c_source.html#l00079">resolve_templ()</a>.</p>

</div>
</div>
<a class="anchor" id="abd958a51bdd3985e29249843cf90b982"></a><!-- doxytag: member="ccn_versioning.c::append_filter_all" ref="abd958a51bdd3985e29249843cf90b982" args="(struct ccn_charbuf *c)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void append_filter_all </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structccn__charbuf.html">ccn_charbuf</a> *&nbsp;</td>
          <td class="paramname"> <em>c</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This appends a filter useful for excluding everything between two 'fenceposts' in an Exclude construct. </p>

<p>Definition at line <a class="el" href="ccn__versioning_8c_source.html#l00038">38</a> of file <a class="el" href="ccn__versioning_8c_source.html">ccn_versioning.c</a>.</p>

<p>Referenced by <a class="el" href="ccn__versioning_8c_source.html#l00079">resolve_templ()</a>.</p>

</div>
</div>
<a class="anchor" id="a5c4d612727219c5b1155c31f2308947f"></a><!-- doxytag: member="ccn_versioning.c::append_future_vcomp" ref="a5c4d612727219c5b1155c31f2308947f" args="(struct ccn_charbuf *templ)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void append_future_vcomp </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structccn__charbuf.html">ccn_charbuf</a> *&nbsp;</td>
          <td class="paramname"> <em>templ</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ccn__versioning_8c_source.html#l00068">68</a> of file <a class="el" href="ccn__versioning_8c_source.html">ccn_versioning.c</a>.</p>

<p>Referenced by <a class="el" href="ccn__versioning_8c_source.html#l00079">resolve_templ()</a>.</p>

</div>
</div>
<a class="anchor" id="af222a5e0ff25d4f2ff60eed72b3defb2"></a><!-- doxytag: member="ccn_versioning.c::ccn_create_version" ref="af222a5e0ff25d4f2ff60eed72b3defb2" args="(struct ccn *h, struct ccn_charbuf *name, int versioning_flags, intmax_t secs, int nsecs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ccn_create_version </td>
          <td>(</td>
          <td class="paramtype">struct ccn *&nbsp;</td>
          <td class="paramname"> <em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structccn__charbuf.html">ccn_charbuf</a> *&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>versioning_flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">intmax_t&nbsp;</td>
          <td class="paramname"> <em>secs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nsecs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Extend a Name with a new version stamp. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>h</em>&nbsp;</td><td>is the the ccn handle. May be NULL. This procedure does not use the connection. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>name</em>&nbsp;</td><td>is a ccnb-encoded Name prefix. By default it gets extended in-place with one additional Component that conforms to the versioning profile and is based on the supplied time, unless a version component is already present. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>versioning_flags</em>&nbsp;</td><td>modifies the default behavior: CCN_V_REPLACE causes the last component to be replaced if it appears to be a version stamp. If CCN_V_HIGH is set as well, an attempt will be made to generate a new version stamp that is later than the existing one, or to return an error. CCN_V_NOW bases the version on the current time rather than the supplied time. CCN_V_NESTOK will allow the new version component to be appended even if there is one there (this makes no difference if CCN_V_REPLACE is also set). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>secs</em>&nbsp;</td><td>is the desired time, in seconds since epoch (ignored if CCN_V_NOW is set). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nsecs</em>&nbsp;</td><td>is the number of nanoseconds. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>-1 for error, 0 for success. </dd></dl>

<p>Definition at line <a class="el" href="ccn__versioning_8c_source.html#l00215">215</a> of file <a class="el" href="ccn__versioning_8c_source.html">ccn_versioning.c</a>.</p>

<p>Referenced by <a class="el" href="ccn__seqwriter_8c_source.html#l00130">ccn_seqw_create()</a>, <a class="el" href="ccnd__internal__client_8c_source.html#l00056">ccnd_init_service_ccnb()</a>, and <a class="el" href="ccnput_8c_source.html#l00109">main()</a>.</p>

</div>
</div>
<a class="anchor" id="ac6285f1a77360610cb68ddfe9769f495"></a><!-- doxytag: member="ccn_versioning.c::ccn_resolve_version" ref="ac6285f1a77360610cb68ddfe9769f495" args="(struct ccn *h, struct ccn_charbuf *name, int versioning_flags, int timeout_ms)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ccn_resolve_version </td>
          <td>(</td>
          <td class="paramtype">struct ccn *&nbsp;</td>
          <td class="paramname"> <em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structccn__charbuf.html">ccn_charbuf</a> *&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>versioning_flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>timeout_ms</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Resolve the version, based on existing ccn content. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>h</em>&nbsp;</td><td>is the the ccn handle; it may be NULL, but it is preferable to use the handle that the client probably already has. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>name</em>&nbsp;</td><td>is a ccnb-encoded Name prefix. It gets extended in-place with one additional Component such that it names highest extant version that can be found, subject to the supplied timeout. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>versioning_flags</em>&nbsp;</td><td>presently must be CCN_V_HIGH or CCN_V_HIGHEST, possibly combined with CCN_V_NESTOK. If CCN_V_NESTOK is not present and the ending component appears to be a version, the routine returns 0 immediately, on the assumption that an explicit version has already been provided. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>timeout_ms</em>&nbsp;</td><td>is a time value in milliseconds. This is applied per fetch attempt, so the total time may be longer by a factor that depends on the number of (ccn) hops to the source(s). </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>-1 for error, 0 if name could not be extended, 1 if was. </dd></dl>

<p>Definition at line <a class="el" href="ccn__versioning_8c_source.html#l00124">124</a> of file <a class="el" href="ccn__versioning_8c_source.html">ccn_versioning.c</a>.</p>

<p>Referenced by <a class="el" href="ccn__header_8c_source.html#l00137">ccn_get_header()</a>, and <a class="el" href="ccncat_8c_source.html#l00184">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a7c3104b723d2ae204e7b853fdeab887b"></a><!-- doxytag: member="ccn_versioning.c::resolve_templ" ref="a7c3104b723d2ae204e7b853fdeab887b" args="(struct ccn_charbuf *templ, unsigned const char *vcomp, int size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structccn__charbuf.html">ccn_charbuf</a>* resolve_templ </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structccn__charbuf.html">ccn_charbuf</a> *&nbsp;</td>
          <td class="paramname"> <em>templ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned const char *&nbsp;</td>
          <td class="paramname"> <em>vcomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ccn__versioning_8c_source.html#l00079">79</a> of file <a class="el" href="ccn__versioning_8c_source.html">ccn_versioning.c</a>.</p>

<p>Referenced by <a class="el" href="ccn__versioning_8c_source.html#l00124">ccn_resolve_version()</a>.</p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Thu Nov 4 13:34:09 2010 for Content-Centric Networking in C by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
