<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Content-Centric Networking in Java: org.ccnx.ccn.impl.security.crypto.KeyDerivationFunction Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><b>org</b>.<b>ccnx</b>.<b>ccn</b>.<b>impl</b>.<b>security</b>.<b>crypto</b>.<a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_key_derivation_function.html">KeyDerivationFunction</a>
  </div>
</div>
<div class="contents">
<h1>org.ccnx.ccn.impl.security.crypto.KeyDerivationFunction Class Reference</h1><!-- doxytag: class="org::ccnx::ccn::impl::security::crypto::KeyDerivationFunction" -->
<p>This class takes a master symmetric key, and derives from it a key and initialization vector to be used to encrypt a specific content object.  
<a href="#_details">More...</a></p>

<p><a href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_key_derivation_function-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static final <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_content_keys_1_1_key_and_i_v.html">KeyAndIV</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_key_derivation_function.html#a7efd0dcb927834936a2fc4f164a7c510">DeriveKeysForObject</a> (String keyAlgorithm, byte[] masterKeyBytes, <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_content_keys_1_1_content_info.html">ContentInfo</a> contentInfo)  throws InvalidKeyException, ContentEncodingException </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Default parameterization of the KDF for standard algorithm type.  <a href="#a7efd0dcb927834936a2fc4f164a7c510"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static final <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_content_keys_1_1_key_and_i_v.html">KeyAndIV</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_key_derivation_function.html#a01923666c08422ff0d86b40a7c75a604">DeriveKeysForObject</a> (String keyAlgorithm, byte[] masterKeyBytes, int keyBitLength, int ivBitLength, <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_content_keys_1_1_content_info.html">ContentInfo</a> contentInfo)  throws InvalidKeyException, ContentEncodingException </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Derive a key and IV for a particular object.  <a href="#a01923666c08422ff0d86b40a7c75a604"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static final byte[]&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_key_derivation_function.html#a66c711e47fcf0fc788e3f2e4fcbd0d50">DeriveKeyForNode</a> (byte[] parentNodeKeyBytes, String label, <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1protocol_1_1_content_name.html">ContentName</a> nodeName)  throws InvalidKeyException, ContentEncodingException </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Used to derive keys for nodes in a name hierarchy.  <a href="#a66c711e47fcf0fc788e3f2e4fcbd0d50"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static final byte[]&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_key_derivation_function.html#a392aed9e61607b99c15e0691329e4112">DeriveKeyForNode</a> (<a class="el" href="classorg_1_1ccnx_1_1ccn_1_1protocol_1_1_content_name.html">ContentName</a> ancestorNodeName, byte[] ancestorNodeKey, String label, <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1protocol_1_1_content_name.html">ContentName</a> nodeName)  throws InvalidKeyException, ContentEncodingException </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Hierarchically derive keys for a child node, given an ancestor key.  <a href="#a392aed9e61607b99c15e0691329e4112"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af91b240425b89d5d082725d88fd8a9b9"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::KeyDerivationFunction::DeriveKeyForNode" ref="af91b240425b89d5d082725d88fd8a9b9" args="(byte[] parentNodeKeyBytes, int keyLengthInBits, String label, ContentName nodeName)" -->
static final byte[]&nbsp;</td><td class="memItemRight" valign="bottom"><b>DeriveKeyForNode</b> (byte[] parentNodeKeyBytes, int keyLengthInBits, String label, <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1protocol_1_1_content_name.html">ContentName</a> nodeName)  throws InvalidKeyException, ContentEncodingException </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static final byte[]&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_key_derivation_function.html#a4b4ae95839f1115e0b325597c1ea5c1b">DeriveKeyForObjectOrNode</a> (byte[] masterKeyBytes, int outputLengthInBits, <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_content_keys_1_1_content_info.html">ContentInfo</a> contentInfo)  throws InvalidKeyException, ContentEncodingException </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Derive a key for a particular object.  <a href="#a4b4ae95839f1115e0b325597c1ea5c1b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static final byte[]&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_key_derivation_function.html#a69055c01053ff5338957e26b09c35166">DeriveKey</a> (byte[] masterKeyBytes, int outputLengthInBits, String label, <a class="el" href="interfaceorg_1_1ccnx_1_1ccn_1_1impl_1_1encoding_1_1_x_m_l_encodable.html">XMLEncodable</a>[] contextObjects)  throws InvalidKeyException, ContentEncodingException </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Core key derivation mechanism.  <a href="#a69055c01053ff5338957e26b09c35166"></a><br/></td></tr>
<tr><td colspan="2"><h2>Static Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static final String&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_key_derivation_function.html#ac695479c6ece13a5f9251c28313b38ed">MAC_ALGORITHM</a> = &quot;HmacSHA256&quot;</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">MAC algorithm used as a PRF.  <a href="#ac695479c6ece13a5f9251c28313b38ed"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>This class takes a master symmetric key, and derives from it a key and initialization vector to be used to encrypt a specific content object. </p>
<p>This simplifies key management by allowing the same master key to be used for families of related content (e.g. all the versions of a file, all of the intrinsic metadata associated with that file, etc.), without having to manage an additional separately wrapped master key. It allows hierarchically delegated access control (i.e. when the children of a node inherit the permissions associated with that node) to proceed without requiring additional keys. It also acts to prevent errors, by limiting the risk of IV/counter reuse, both by distributing encryption across many derived keys, and deriving the IV/counter seeds automatically for programmers.</p>
<p>NOTE: This is a low-level cryptographic API. This class is used internally by CCN's built in access control prototype, and may be used for key derivation in general, for people building other encryption models for CCN. However, if you don't already know what "key derivation" means, you should NOT be using it -- there is probably a different API that more closely fits your needs.</p>
<p>For each block, we compute the PRF using key K over (counter || label || 0x00 || context || L) where L is the desired output length in bits.</p>
<p>We encode the counter and L both in 32 bit fields. The counter is initialized to 1.</p>
<p>The KDF implemented herein is from NIST special publication 108-008, and is described in more detail in the CCN documentation. </p>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a69055c01053ff5338957e26b09c35166"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::KeyDerivationFunction::DeriveKey" ref="a69055c01053ff5338957e26b09c35166" args="(byte[] masterKeyBytes, int outputLengthInBits, String label, XMLEncodable[] contextObjects)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static final byte [] org.ccnx.ccn.impl.security.crypto.KeyDerivationFunction.DeriveKey </td>
          <td>(</td>
          <td class="paramtype">byte[]&nbsp;</td>
          <td class="paramname"> <em>masterKeyBytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>outputLengthInBits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">String&nbsp;</td>
          <td class="paramname"> <em>label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interfaceorg_1_1ccnx_1_1ccn_1_1impl_1_1encoding_1_1_x_m_l_encodable.html">XMLEncodable</a>[]&nbsp;</td>
          <td class="paramname"> <em>contextObjects</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td>  throws InvalidKeyException, <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1io_1_1content_1_1_content_encoding_exception.html">ContentEncodingException</a> <code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Core key derivation mechanism. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>masterKeyBytes</em>&nbsp;</td><td>master key to derive a new key from </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>outputLengthInBits</em>&nbsp;</td><td>bit length of key to derive </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>label</em>&nbsp;</td><td>a text label to allow derivation of multiple key types from a single source key/path pair </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>contextObjects</em>&nbsp;</td><td>objects to add into the KDF as context. Usually at least the name of the node, also possibly the publisher. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the derived key </dd></dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InvalidKeyException</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ContentEncodingException</em>&nbsp;</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a392aed9e61607b99c15e0691329e4112"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::KeyDerivationFunction::DeriveKeyForNode" ref="a392aed9e61607b99c15e0691329e4112" args="(ContentName ancestorNodeName, byte[] ancestorNodeKey, String label, ContentName nodeName)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static final byte [] org.ccnx.ccn.impl.security.crypto.KeyDerivationFunction.DeriveKeyForNode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1protocol_1_1_content_name.html">ContentName</a>&nbsp;</td>
          <td class="paramname"> <em>ancestorNodeName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte[]&nbsp;</td>
          <td class="paramname"> <em>ancestorNodeKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">String&nbsp;</td>
          <td class="paramname"> <em>label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1protocol_1_1_content_name.html">ContentName</a>&nbsp;</td>
          <td class="paramname"> <em>nodeName</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td>  throws InvalidKeyException, <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1io_1_1content_1_1_content_encoding_exception.html">ContentEncodingException</a> <code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Hierarchically derive keys for a child node, given an ancestor key. </p>
<p>Why not do this in one step, with no intervening keys? This way we can delegate/install backlinks to keys in the middle of the hierarchy and things continue to work. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ancestorNodeName</em>&nbsp;</td><td>the node with whom ancestorNodeKey is associated. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ancestorNodeKey</em>&nbsp;</td><td>the key associated with that ancestor node </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>label</em>&nbsp;</td><td>a text label to allow derivation of multiple key types from a single source key/path pair </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nodeName</em>&nbsp;</td><td>the name of the node to derive a key for </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InvalidKeyException</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ContentEncodingException</em>&nbsp;</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a66c711e47fcf0fc788e3f2e4fcbd0d50"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::KeyDerivationFunction::DeriveKeyForNode" ref="a66c711e47fcf0fc788e3f2e4fcbd0d50" args="(byte[] parentNodeKeyBytes, String label, ContentName nodeName)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static final byte [] org.ccnx.ccn.impl.security.crypto.KeyDerivationFunction.DeriveKeyForNode </td>
          <td>(</td>
          <td class="paramtype">byte[]&nbsp;</td>
          <td class="paramname"> <em>parentNodeKeyBytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">String&nbsp;</td>
          <td class="paramname"> <em>label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1protocol_1_1_content_name.html">ContentName</a>&nbsp;</td>
          <td class="paramname"> <em>nodeName</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td>  throws InvalidKeyException, <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1io_1_1content_1_1_content_encoding_exception.html">ContentEncodingException</a> <code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Used to derive keys for nodes in a name hierarchy. </p>
<p>The key must be independent of publisher, as it is used to derive keys for intermediate nodes. As this is used as input to another key derivation call, no IV is derived. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>parentNodeKeyBytes</em>&nbsp;</td><td>the initial source key to derive further keys from </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>label</em>&nbsp;</td><td>a text label to allow derivation of multiple key types from a single source key/path pair </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nodeName</em>&nbsp;</td><td>the name of the node to derive a key for </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InvalidKeyException</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ContentEncodingException</em>&nbsp;</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a4b4ae95839f1115e0b325597c1ea5c1b"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::KeyDerivationFunction::DeriveKeyForObjectOrNode" ref="a4b4ae95839f1115e0b325597c1ea5c1b" args="(byte[] masterKeyBytes, int outputLengthInBits, ContentInfo contentInfo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static final byte [] org.ccnx.ccn.impl.security.crypto.KeyDerivationFunction.DeriveKeyForObjectOrNode </td>
          <td>(</td>
          <td class="paramtype">byte[]&nbsp;</td>
          <td class="paramname"> <em>masterKeyBytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>outputLengthInBits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_content_keys_1_1_content_info.html">ContentInfo</a>&nbsp;</td>
          <td class="paramname"> <em>contentInfo</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td>  throws InvalidKeyException, <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1io_1_1content_1_1_content_encoding_exception.html">ContentEncodingException</a> <code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Derive a key for a particular object. </p>
<p>Requested bit lengths must be divisible by BITS_PER_BYTE. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>masterKeyBytes</em>&nbsp;</td><td>master key to derive a new key from </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>outputLengthInBits</em>&nbsp;</td><td>bit length of key to derive </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>label</em>&nbsp;</td><td>a text label to allow derivation of multiple key types from a single source key/path pair </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>contentName</em>&nbsp;</td><td>name to derive a key for </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>publisher</em>&nbsp;</td><td>publisher whose version of contentName we want to derive for </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>returns a key for this object </dd></dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InvalidKeyException</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ContentEncodingException</em>&nbsp;</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a01923666c08422ff0d86b40a7c75a604"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::KeyDerivationFunction::DeriveKeysForObject" ref="a01923666c08422ff0d86b40a7c75a604" args="(String keyAlgorithm, byte[] masterKeyBytes, int keyBitLength, int ivBitLength, ContentInfo contentInfo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static final <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_content_keys_1_1_key_and_i_v.html">KeyAndIV</a> org.ccnx.ccn.impl.security.crypto.KeyDerivationFunction.DeriveKeysForObject </td>
          <td>(</td>
          <td class="paramtype">String&nbsp;</td>
          <td class="paramname"> <em>keyAlgorithm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte[]&nbsp;</td>
          <td class="paramname"> <em>masterKeyBytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>keyBitLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ivBitLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_content_keys_1_1_content_info.html">ContentInfo</a>&nbsp;</td>
          <td class="paramname"> <em>contentInfo</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td>  throws InvalidKeyException, <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1io_1_1content_1_1_content_encoding_exception.html">ContentEncodingException</a> <code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Derive a key and IV for a particular object. </p>
<p>Requested bit lengths must be divisible by BITS_PER_BYTE. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>masterKeyBytes</em>&nbsp;</td><td>master key to derive a new key from </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>keyBitLength</em>&nbsp;</td><td>bit length of key to derive </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ivBitLength</em>&nbsp;</td><td>bit length of iv to derive </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>label</em>&nbsp;</td><td>a text label to allow derivation of multiple key types from a single source key/path pair </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>contentName</em>&nbsp;</td><td>name to derive a key for </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>publisher</em>&nbsp;</td><td>publisher whose version of contentName we want to derive for </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>returns an {key, iv/counter seed} pair suitable for use in segment encryption </dd></dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InvalidKeyException</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ContentEncodingException</em>&nbsp;</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a7efd0dcb927834936a2fc4f164a7c510"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::KeyDerivationFunction::DeriveKeysForObject" ref="a7efd0dcb927834936a2fc4f164a7c510" args="(String keyAlgorithm, byte[] masterKeyBytes, ContentInfo contentInfo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static final <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_content_keys_1_1_key_and_i_v.html">KeyAndIV</a> org.ccnx.ccn.impl.security.crypto.KeyDerivationFunction.DeriveKeysForObject </td>
          <td>(</td>
          <td class="paramtype">String&nbsp;</td>
          <td class="paramname"> <em>keyAlgorithm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte[]&nbsp;</td>
          <td class="paramname"> <em>masterKeyBytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_content_keys_1_1_content_info.html">ContentInfo</a>&nbsp;</td>
          <td class="paramname"> <em>contentInfo</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td>  throws InvalidKeyException, <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1io_1_1content_1_1_content_encoding_exception.html">ContentEncodingException</a> <code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Default parameterization of the KDF for standard algorithm type. </p>
<p>This is the routine that will be typically used by code that does not want to override default algorithms. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>masterKeyBytes</em>&nbsp;</td><td>the source key from which to derive a subkey </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>label</em>&nbsp;</td><td>a text label for additional parameterization, if desired </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>contentName</em>&nbsp;</td><td>name of the specific object to derive a key for, including the version (but not including segment information). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>publisher</em>&nbsp;</td><td>for this particular set of objects </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InvalidKeyException</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ContentEncodingException</em>&nbsp;</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="ac695479c6ece13a5f9251c28313b38ed"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::KeyDerivationFunction::MAC_ALGORITHM" ref="ac695479c6ece13a5f9251c28313b38ed" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">final String <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_key_derivation_function.html#ac695479c6ece13a5f9251c28313b38ed">org.ccnx.ccn.impl.security.crypto.KeyDerivationFunction.MAC_ALGORITHM</a> = &quot;HmacSHA256&quot;<code> [static, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>MAC algorithm used as a PRF. </p>
<p>We use HMAC-SHA256 as our primary PRF, because it is the most commonly implemented acceptable option. CMAC would be preferable, but is not universally available yet. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/org/ccnx/ccn/impl/security/crypto/KeyDerivationFunction.java</li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Thu Nov 4 13:34:27 2010 for Content-Centric Networking in Java by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
