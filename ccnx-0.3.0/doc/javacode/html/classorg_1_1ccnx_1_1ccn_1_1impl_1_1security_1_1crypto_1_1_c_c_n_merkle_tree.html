<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Content-Centric Networking in Java: org.ccnx.ccn.impl.security.crypto.CCNMerkleTree Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><b>org</b>.<b>ccnx</b>.<b>ccn</b>.<b>impl</b>.<b>security</b>.<b>crypto</b>.<a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_c_c_n_merkle_tree.html">CCNMerkleTree</a>
  </div>
</div>
<div class="contents">
<h1>org.ccnx.ccn.impl.security.crypto.CCNMerkleTree Class Reference</h1><!-- doxytag: class="org::ccnx::ccn::impl::security::crypto::CCNMerkleTree" --><!-- doxytag: inherits="org::ccnx::ccn::impl::security::crypto::MerkleTree" -->
<p>Extends the basic <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_merkle_tree.html" title="Implementation of a Merkle hash tree.">MerkleTree</a> for use in CCN.  
<a href="#_details">More...</a></p>

<p><a href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_c_c_n_merkle_tree-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_c_c_n_merkle_tree.html#a123677dd28759fac16831d7b8d1ab75e">CCNMerkleTree</a> (<a class="el" href="classorg_1_1ccnx_1_1ccn_1_1protocol_1_1_content_object.html">ContentObject</a>[] contentObjects, PrivateKey signingKey)  throws NoSuchAlgorithmException, InvalidKeyException, SignatureException </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Build a <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_c_c_n_merkle_tree.html" title="Extends the basic MerkleTree for use in CCN.">CCNMerkleTree</a> from a set of leaf ContentObjects.  <a href="#a123677dd28759fac16831d7b8d1ab75e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">byte[]&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_c_c_n_merkle_tree.html#a8c1c4dd9abba424ad1cbea5535802ab2">rootSignature</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the root signature on the tree.  <a href="#a8c1c4dd9abba424ad1cbea5535802ab2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1protocol_1_1_content_name.html">ContentName</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_c_c_n_merkle_tree.html#a0e9c8069c770319ce8915105994f9d54">segmentName</a> (int leafIndex)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Generate the name of segment leafIndex, where leafIndex is the leaf number in this tree.  <a href="#a0e9c8069c770319ce8915105994f9d54"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1protocol_1_1_signed_info.html">SignedInfo</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_c_c_n_merkle_tree.html#a8abbe97fc19a1961c561a0200300b4c2">segmentSignedInfo</a> (int leafIndex)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the SignedInfo for a given segment.  <a href="#a8abbe97fc19a1961c561a0200300b4c2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1protocol_1_1_signature.html">Signature</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_c_c_n_merkle_tree.html#a8741aad0b944d6eb8e7ad7376a90bd92">segmentSignature</a> (int leafIndex)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the signature for a particular segment.  <a href="#a8741aad0b944d6eb8e7ad7376a90bd92"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0a46e6973fe2bbcff96f96c4e9b714ac"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::CCNMerkleTree::setSignatures" ref="a0a46e6973fe2bbcff96f96c4e9b714ac" args="()" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_c_c_n_merkle_tree.html#a0a46e6973fe2bbcff96f96c4e9b714ac">setSignatures</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets the signatures of all the contained ContentObjects. <br/></td></tr>
<tr><td colspan="2"><h2>Static Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a76093687bf5098eca0fc23b4d73c6b65"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::CCNMerkleTree::DEFAULT_MHT_ALGORITHM" ref="a76093687bf5098eca0fc23b4d73c6b65" args="" -->
static final String&nbsp;</td><td class="memItemRight" valign="bottom"><b>DEFAULT_MHT_ALGORITHM</b> = &quot;SHA256MHT&quot;</td></tr>
<tr><td colspan="2"><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_c_c_n_merkle_tree.html#a3882f83b9cbcd5512031493fa3acdeb2">initializeTree</a> (<a class="el" href="classorg_1_1ccnx_1_1ccn_1_1protocol_1_1_content_object.html">ContentObject</a>[] contentObjects)  throws NoSuchAlgorithmException </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">A version of initializeTree to go with the <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_c_c_n_merkle_tree.html" title="Extends the basic MerkleTree for use in CCN.">CCNMerkleTree</a>(ContentObject []) constructor.  <a href="#a3882f83b9cbcd5512031493fa3acdeb2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1protocol_1_1_signature.html">Signature</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_c_c_n_merkle_tree.html#a9818a56967d1613151a9070dda1c7c96">computeSignature</a> (int leafIndex)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Construct the Signature for a given leaf.  <a href="#a9818a56967d1613151a9070dda1c7c96"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_c_c_n_merkle_tree.html#a47c69979b5179ba6877e488c510c0576">computeLeafValues</a> (<a class="el" href="classorg_1_1ccnx_1_1ccn_1_1protocol_1_1_content_object.html">ContentObject</a>[] contentObjects)  throws NoSuchAlgorithmException </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute the leaf values of the ContentObjects in this tree.  <a href="#a47c69979b5179ba6877e488c510c0576"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">byte[]&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_c_c_n_merkle_tree.html#a476635d1bc7f1773f0402de2a476287b">computeBlockDigest</a> (int leafIndex, byte[] content, int offset, int length)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">We need to incorporate the name of the content block and the signedInfo into the leaf digest of the tree.  <a href="#a476635d1bc7f1773f0402de2a476287b"></a><br/></td></tr>
<tr><td colspan="2"><h2>Static Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static byte[]&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_c_c_n_merkle_tree.html#ac7ccf51464ec2d3f7082e227b9cac896">computeRootSignature</a> (byte[] root, PrivateKey signingKey)  throws InvalidKeyException, SignatureException, NoSuchAlgorithmException </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute the signature on the root node.  <a href="#ac7ccf51464ec2d3f7082e227b9cac896"></a><br/></td></tr>
<tr><td colspan="2"><h2>Package Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a76a449209d950f3598c7f68459f47353"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::CCNMerkleTree::_rootSignature" ref="a76a449209d950f3598c7f68459f47353" args="" -->
byte[]&nbsp;</td><td class="memItemRight" valign="bottom"><b>_rootSignature</b> = null</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a863aff58f41ef7274ad3a5a0e3b681d7"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::CCNMerkleTree::_segmentObjects" ref="a863aff58f41ef7274ad3a5a0e3b681d7" args="" -->
<a class="el" href="classorg_1_1ccnx_1_1ccn_1_1protocol_1_1_content_object.html">ContentObject</a>[]&nbsp;</td><td class="memItemRight" valign="bottom"><b>_segmentObjects</b> = null</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Extends the basic <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_merkle_tree.html" title="Implementation of a Merkle hash tree.">MerkleTree</a> for use in CCN. </p>
<p>It incorporates the CCN ContentName for an object at each node, so that names are authenticated as well as content in a way that intermediary CCN nodes can verify.</p>
<p>For each leaf node in the <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_c_c_n_merkle_tree.html" title="Extends the basic MerkleTree for use in CCN.">CCNMerkleTree</a>, we compute its digest in exactly the same way we would compute the digest of a ContentObject node for signing on its own (incorporating the name, authentication metadata, and content). We then combine all these leaf digests together into a <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_merkle_tree.html" title="Implementation of a Merkle hash tree.">MerkleTree</a>, and sign the root node.</p>
<p>To generate a leaf block digest, therefore, we need to know</p>
<ul>
<li>the content of the block</li>
<li>the name for the block (which, for segmented content, includes the segmented number. If we're buffering content and building trees per buffer, the fragment numbers may carry across buffers (e.g. leaf 0 of this tree might be fragment 37 of the content as a whole)</li>
</ul>
<ul>
<li>the authentication metadata. In the case of fragmented content, this is likely to be the same for all blocks. In the case of other content, the publisher is likely to be the same, but the timestamp and even maybe the type could be different -- i.e. you could use a <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_c_c_n_merkle_tree.html" title="Extends the basic MerkleTree for use in CCN.">CCNMerkleTree</a> to amortize signature costs over any collection of data, not just a set of fragments.</li>
</ul>
<p>So, we either need to hand in all the names, or have a function to call to get the name for each block.</p>
<p>Note: There is no requirement that a <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_c_c_n_merkle_tree.html" title="Extends the basic MerkleTree for use in CCN.">CCNMerkleTree</a> be built only from the segments of a single piece of content, although that is the most common use. One can build and verify a <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_c_c_n_merkle_tree.html" title="Extends the basic MerkleTree for use in CCN.">CCNMerkleTree</a> built out of an arbitrary set of ContentObjects; this may be a useful way of limiting the number of signatures generated on constrained platforms. Eventually the <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1_c_c_n_segmenter.html" title="Combines segmentation, signing and encryption.">CCNSegmenter</a> will be extended to handle such collections of arbitrary objects. </p>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a123677dd28759fac16831d7b8d1ab75e"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::CCNMerkleTree::CCNMerkleTree" ref="a123677dd28759fac16831d7b8d1ab75e" args="(ContentObject[] contentObjects, PrivateKey signingKey)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">org.ccnx.ccn.impl.security.crypto.CCNMerkleTree.CCNMerkleTree </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1protocol_1_1_content_object.html">ContentObject</a>[]&nbsp;</td>
          <td class="paramname"> <em>contentObjects</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PrivateKey&nbsp;</td>
          <td class="paramname"> <em>signingKey</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td>  throws NoSuchAlgorithmException, InvalidKeyException, SignatureException </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Build a <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_c_c_n_merkle_tree.html" title="Extends the basic MerkleTree for use in CCN.">CCNMerkleTree</a> from a set of leaf ContentObjects. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>contentObjects</em>&nbsp;</td><td>must be at least 2 blocks, or will throw IllegalArgumentException. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>signingKey</em>&nbsp;</td><td>key to sign the root with </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>NoSuchAlgorithmException</em>&nbsp;</td><td>if key or DEFAULT_DIGEST_ALGORITHM are unknown </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>InvalidKeyException</em>&nbsp;</td><td>if signingKey is invalid </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>SignatureException</em>&nbsp;</td><td>if we cannot sign </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a476635d1bc7f1773f0402de2a476287b"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::CCNMerkleTree::computeBlockDigest" ref="a476635d1bc7f1773f0402de2a476287b" args="(int leafIndex, byte[] content, int offset, int length)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">byte [] org.ccnx.ccn.impl.security.crypto.CCNMerkleTree.computeBlockDigest </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>leafIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte[]&nbsp;</td>
          <td class="paramname"> <em>content</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>We need to incorporate the name of the content block and the signedInfo into the leaf digest of the tree. </p>
<p>Essentially, we want the leaf digest to be the same thing we would use for signing a stand-alone ContentObject. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>leafIndex</em>&nbsp;</td><td>the index of the leaf to sign </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>content</em>&nbsp;</td><td>the content array containing the leaf content </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>offset</em>&nbsp;</td><td>the offset into content where the leaf start </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>the length of content for this leaf </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the block digest </dd></dl>

<p>Reimplemented from <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_merkle_tree.html#a2dc111a42dbfe99fce825d0221a7b4b8">org.ccnx.ccn.impl.security.crypto.MerkleTree</a>.</p>

</div>
</div>
<a class="anchor" id="a47c69979b5179ba6877e488c510c0576"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::CCNMerkleTree::computeLeafValues" ref="a47c69979b5179ba6877e488c510c0576" args="(ContentObject[] contentObjects)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void org.ccnx.ccn.impl.security.crypto.CCNMerkleTree.computeLeafValues </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1protocol_1_1_content_object.html">ContentObject</a>[]&nbsp;</td>
          <td class="paramname"> <em>contentObjects</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td>  throws NoSuchAlgorithmException <code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Compute the leaf values of the ContentObjects in this tree. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>contentObjects</em>&nbsp;</td><td>the content </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>NoSuchAlgorithmException</em>&nbsp;</td><td>if the digestAlgorithm unknown </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ac7ccf51464ec2d3f7082e227b9cac896"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::CCNMerkleTree::computeRootSignature" ref="ac7ccf51464ec2d3f7082e227b9cac896" args="(byte[] root, PrivateKey signingKey)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static byte [] org.ccnx.ccn.impl.security.crypto.CCNMerkleTree.computeRootSignature </td>
          <td>(</td>
          <td class="paramtype">byte[]&nbsp;</td>
          <td class="paramname"> <em>root</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PrivateKey&nbsp;</td>
          <td class="paramname"> <em>signingKey</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td>  throws InvalidKeyException, SignatureException, NoSuchAlgorithmException <code> [static, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Compute the signature on the root node. </p>
<p>It's already a digest, so in theory we could just wrap it up in some PKCS#1 padding, encrypt it with our private key, and voila! A signature. But there are basically no crypto software packages that provide signature primitives that take already-digested data and just do the padding and encryption, and so we'd be asking anyone attempting to implement CCN MHT signing (including ourselves) to re-implement a very complicated wheel, across a number of signature algorithms. We might also want to sign with a key that does not <a class="el" href="namespaceorg_1_1ccnx_1_1ccn_1_1impl_1_1support.html" title="PD org.ccnx.ccn.impl.support.">support</a> the digest algorithm we used to compute the root (for example, DSA). So take the computationally very slightly more expensive, but vastly simpler (implementation-wise) approach of taking our digest and signing it with a standard signing API -- which means digesting it one more time for the signature. So we sign (digest + encrypt) the root digest.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>root</em>&nbsp;</td><td>the root digest to sign </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>signingKey</em>&nbsp;</td><td>the key to sign with </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the bytes of the signature </dd></dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InvalidKeyException</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>SignatureException</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>NoSuchAlgorithmException</em>&nbsp;</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a9818a56967d1613151a9070dda1c7c96"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::CCNMerkleTree::computeSignature" ref="a9818a56967d1613151a9070dda1c7c96" args="(int leafIndex)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1protocol_1_1_signature.html">Signature</a> org.ccnx.ccn.impl.security.crypto.CCNMerkleTree.computeSignature </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>leafIndex</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Construct the Signature for a given leaf. </p>
<p>This is composed of the <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_c_c_n_merkle_tree.html#a8c1c4dd9abba424ad1cbea5535802ab2" title="Returns the root signature on the tree.">rootSignature()</a>, which is the same for all nodes, and the DER encoded <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_merkle_path.html" title="A representation of a path through a MerkleTree.">MerklePath</a> for this leaf as the witness. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>leafIndex</em>&nbsp;</td><td>the leaf to compute the signature for </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the signature </dd></dl>

</div>
</div>
<a class="anchor" id="a3882f83b9cbcd5512031493fa3acdeb2"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::CCNMerkleTree::initializeTree" ref="a3882f83b9cbcd5512031493fa3acdeb2" args="(ContentObject[] contentObjects)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void org.ccnx.ccn.impl.security.crypto.CCNMerkleTree.initializeTree </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1protocol_1_1_content_object.html">ContentObject</a>[]&nbsp;</td>
          <td class="paramname"> <em>contentObjects</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td>  throws NoSuchAlgorithmException <code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>A version of initializeTree to go with the <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_c_c_n_merkle_tree.html" title="Extends the basic MerkleTree for use in CCN.">CCNMerkleTree</a>(ContentObject []) constructor. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>contentObjects</em>&nbsp;</td><td>objects to build into the tree </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>NoSuchAlgorithmException</em>&nbsp;</td><td>if the default digest algorithm unknown </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a8c1c4dd9abba424ad1cbea5535802ab2"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::CCNMerkleTree::rootSignature" ref="a8c1c4dd9abba424ad1cbea5535802ab2" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">byte [] org.ccnx.ccn.impl.security.crypto.CCNMerkleTree.rootSignature </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the root signature on the tree. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>the root signature </dd></dl>

</div>
</div>
<a class="anchor" id="a0e9c8069c770319ce8915105994f9d54"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::CCNMerkleTree::segmentName" ref="a0e9c8069c770319ce8915105994f9d54" args="(int leafIndex)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1protocol_1_1_content_name.html">ContentName</a> org.ccnx.ccn.impl.security.crypto.CCNMerkleTree.segmentName </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>leafIndex</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Generate the name of segment leafIndex, where leafIndex is the leaf number in this tree. </p>
<p>The overall index of leafIndex should be leafIndex + baseNameIndex(). </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>leafIndex</em>&nbsp;</td><td>the leaf whose blockName to generate </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the name </dd></dl>

</div>
</div>
<a class="anchor" id="a8741aad0b944d6eb8e7ad7376a90bd92"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::CCNMerkleTree::segmentSignature" ref="a8741aad0b944d6eb8e7ad7376a90bd92" args="(int leafIndex)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1protocol_1_1_signature.html">Signature</a> org.ccnx.ccn.impl.security.crypto.CCNMerkleTree.segmentSignature </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>leafIndex</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set the signature for a particular segment. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>leafIndex</em>&nbsp;</td><td>the leaf segment to set the signature for </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the Signature </dd></dl>

</div>
</div>
<a class="anchor" id="a8abbe97fc19a1961c561a0200300b4c2"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::CCNMerkleTree::segmentSignedInfo" ref="a8abbe97fc19a1961c561a0200300b4c2" args="(int leafIndex)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1protocol_1_1_signed_info.html">SignedInfo</a> org.ccnx.ccn.impl.security.crypto.CCNMerkleTree.segmentSignedInfo </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>leafIndex</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return the SignedInfo for a given segment. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>leafIndex</em>&nbsp;</td><td>the index of the leaf whose SignedInfo we want </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the SignedInfo </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/org/ccnx/ccn/impl/security/crypto/CCNMerkleTree.java</li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Thu Nov 4 13:34:27 2010 for Content-Centric Networking in Java by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
